# 3. Le CLI ansible-inventory

## 3.1. ansible-inventory

La commande **ansible-inventory** est un outil en ligne de commande fourni avec **Ansible**, qui vous permet de travailler avec les inventaires **Ansible**.

Il peut être utilisé pour afficher et manipuler les **inventaires**, ainsi que pour convertir entre différents formats d'inventaire.

## 3.2. Principales commandes et options :

`--list` : affiche l'inventaire sous forme de JSON. Cela peut être utile pour voir la structure complète de l'inventaire, y compris les hôtes, les groupes, et toutes les variables associées.

```JSON
{
    "_meta": {
        "hostvars": {
            "managed-node1": {
                "ansible_host": "172.16.128.11",
                "ansible_ssh_private_key_file": "~/.ssh/ssh_key_developer",
                "ansible_user": "sysadm",
                "common_variable": "I am a common variable for all hosts",
                "group_variable": "I am a variable of the managed_nodes group",
                "host_variable": "I am a variable specific to managed-node1"
            },
            "managed-node2": {
                "ansible_host": "172.16.128.12",
                "ansible_ssh_private_key_file": "~/.ssh/ssh_key_developer",
                "ansible_user": "sysadm",
                "common_variable": "I am a common variable for all hosts",
                "group_variable": "I am a variable of the managed_nodes group",
                "host_variable": "I am a variable specific to managed-node2"
            },
            "managed-node3": {
                "ansible_host": "172.16.128.13",
                "ansible_ssh_private_key_file": "~/.ssh/ssh_key_developer",
                "ansible_user": "sysadm",
                "common_variable": "I am a common variable for all hosts",
                "group_variable": "I am a variable of the managed_nodes group",
                "host_variable": "I am a variable specific to managed-node3"
            },
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "managed_nodes"
        ]
    },
    "managed_nodes": {
        "hosts": [
            "managed-node1",
            "managed-node2",
            "managed-node3"
        ]
    }
}
```

`--graph` : affiche un graphique de l'inventaire, montrant la hiérarchie des groupes et les membres de chaque groupe.

```TEXT
@all:
  |--@ungrouped:
  |--@managed_nodes:
  |  |--managed-node1
  |  |--managed-node2
  |  |--managed-node3
```

`--host` : prend en argument un nom d'hôte et affiche toutes les variables associées à cet hôte en format **JSON**.

```SHELL
ansible-inventory -i inventory/ --host managed-node1
```

```JSON
{
    "ansible_host": "172.16.128.11",
    "ansible_ssh_private_key_file": "~/.ssh/ssh_key_developer",
    "ansible_user": "sysadm",
    "common_variable": "I am a common variable for all hosts",
    "group_variable": "I am a variable of the managed_nodes group",
    "host_variable": "I am a variable specific to managed-node1"
}
```

`-i` ou `--inventory` : Spécifie le chemin d'accès au fichier d'inventaire.

`--yaml` : utilisé avec `--list` pour afficher l'inventaire au format **YAML** plutôt qu'en **JSON**.

```YAML
all:
  children:
  managed_nodes:
    hosts:
      managed-node1:
        ansible_host: 172.16.128.11
        ansible_user": sysadm
        ansible_ssh_private_key_file: ~/.ssh/ssh_key_developer
        common_variable: I am a common variable for all hosts
        group_variable: I am a variable of the managed_nodes group
        host_variable: I am a variable specific to managed-node1
      managed-node2:
        ansible_host: 172.16.128.12
        ansible_user: sysadm
        ansible_ssh_private_key_file: ~/.ssh/ssh_key_developer
        common_variable: I am a common variable for all hosts
        group_variable: I am a variable of the managed_nodes group
        host_variable: I am a variable specific to managed-node2
      managed-node3:
        ansible_host: 172.16.128.13
        ansible_user: sysadm
        ansible_ssh_private_key_file: ~/.ssh/ssh_key_developer
        common_variable: I am a common variable for all hosts
        group_variable: I am a variable of the managed_nodes group
        host_variable: I am a variable specific to managed-node3
```
