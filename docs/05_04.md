# 4. Le module file

## 4.1. Le module file

Le module `ansible.builtin.file` est principalement utilisé pour gérer les fichiers, les répertoires et les liens symboliques ainsi que leurs propriétés.

Il permet de :

- Définir les attributs des fichiers, répertoires ou liens symboliques et leurs cibles.
- Supprimer des fichiers, liens symboliques ou répertoires.

De nombreux autres modules supportent les mêmes options que le module `ansible.builtin.file`, y compris `ansible.builtin.copy` que nous venons de voir.

## 4.2. Les paramètres disponibles

Voici une liste des principaux paramètres du module :

- **access_time** : définit le temps d'accès d'un fichier. Peut être 'preserve', une date au format `YYYYMMDDHHMM.SS`, ou 'now'.
- **access_time_format** : format du temps à utiliser avec **access_time**, par défaut "`%Y%m%d%H%M.%S`".
- **attributes** : attributs que l'objet système de fichiers résultant doit avoir, comme spécifié par **chattr**.
- **follow** : indique si les liens de système de fichiers doivent être suivis.
- **force** : force la création de liens symboliques même si la source n'existe pas ou si la destination est un fichier existant.
- **group** : nom du groupe qui doit posséder l'objet système de fichiers.
- **mode** : permissions que l'objet système de fichiers résultant doit avoir, peut être spécifié en octal ou en mode symbolique.
- **modification_time** : définit le temps de modification d'un fichier. Peut être 'preserve', une date au format `YYYYMMDDHHMM.SS`, ou 'now'.
- **modification_time_format** : format du temps à utiliser avec - **modification_time**, par défaut "`%Y%m%d%H%M.%S`".
- **owner** : nom de l'utilisateur qui doit posséder l'objet système de fichiers.
- **path** : chemin vers le fichier à gérer.
- **recurse** : applique récursivement les attributs spécifiés aux contenus d'un répertoire.
- **selevel**, **serole**, **setype**, **seuser** : parties du contexte **SELinux**.
- **src** : chemin du fichier à lier (pour **state=link** et **state=hard**).
- **state** : état souhaité de l'objet système de fichiers (**absent**, **directory**, **file**, **hard**, **link**, **touch**).
- **unsafe_writes** : influence l'utilisation des opérations atomiques pour prévenir les corruptions de données.

## 4.3. Exemples d'utilisation

### Changer la propriété, le groupe et les permissions d'un fichier

```YAML
- name: Change property, group and permission of file
  ansible.builtin.file:
    path: /etc/foo.conf    # path to the file
    owner: john            # owner user
    group: users           # owner group
    mode: '0644'           # permissions
```

### Créer un répertoire s'il n'existe pas

```YAML
- name: Create folder if not exists
  ansible.builtin.file:
    path: /etc/folder      # path to the folder
    state: directory       # state of file (directory)
    mode: '0755'           # permissions
```

### Supprimer un fichier

```YAML
- name: Delete a file
  ansible.builtin.file:
    path: /etc/file_to_delete.txt  # path to file to delete
    state: absent                  # state of file (absent means delete)
```
