# 2. Le module raw

## 2.1. Exemple du module raw

Chaque module a [une page détaillé de présentation](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/raw_module.html#ansible-collections-ansible-builtin-raw-module) avec un résumé de son fonctionnement, les paramètres et attributs qu'il prend, des notes, les modules connexes et des exemples.

En reprenant les éléments essentiels de la page de ce module, nous avons :

### Synopsis

Ce module permet d'exécuter des commandes **SSH** brutes, qui ne sont pas traitées par le système de modules d'**Ansible**.

C'est particulièrement utile pour les cas spécifiques tels que l'installation de **Python** sur des systèmes qui n'en sont pas équipés par défaut, ou pour interagir avec des appareils qui ne possèdent pas **Python**, comme certains routeurs.

Dans la plupart des autres cas, il est recommandé d'utiliser les modules `ansible.builtin.shell` ou `ansible.builtin.command` qui offrent plus de contrôle et de sécurité.

### Paramètres

- **executable (string)** : permet de modifier le **shell** utilisé pour exécuter la commande. Il doit s'agir du chemin absolu vers l'exécutable. Ceci est particulièrement utile lorsque vous utilisez l'escalade de privilèges (avec **become -b**), car **un shell** par défaut sera nécessaire.

- **free_form (string, requis)** : ce paramètre prend une commande en forme libre à exécuter. Il n'y a pas de paramètre nommé ‘free form’; c'est plutôt une manière de dire que ce module accepte une chaîne libre qui est directement passée au **shell**.

### Attributs

- **check_mode (none)** : ce module peut s'exécuter en mode vérification (**check_mode**) et retourner un statut de changement prédit sans modifier la cible.

- **diff_mode (none)** : ne retourne pas de détails sur ce qui a changé ou doit changer lorsqu'il est utilisé en mode diff.

- **platform (all)** : ce module ne nécessite pas **Python** sur la machine distante, car il envoie directement la commande dans la chaîne de connexion.

### Notes

- Utiliser `ansible.builtin.raw` dans un **playbook** pourrait nécessiter de désactiver la collecte de faits avec `gather_facts: no`, surtout si vous utilisez **raw** pour installer **Python** sur la machine.

- L’utilisation de la commande **raw** pour exécuter des commandes de manière sécurisée et prévisible est moins recommandée que d'utiliser `ansible.builtin.command` ou `ansible.builtin.shell`.

- Le mot-clé **environment** ne fonctionne généralement pas avec **raw** car il nécessite un **shell** pour être interprété, sauf si l'option **executable** est définie ou si le module est utilisé avec une escalade de privilèges.

### Exemples

```YAML
- name: Initialize host without Python3 installed on it
  ansible.builtin.raw: dnf install -y python3 python3-dnf libselinux-python

- name: Execute command using a non POSIX shell
  ansible.builtin.raw: cat < /tmp/*txt
  args:
    executable: /bin/bash

- name: List Widows users account
  ansible.builtin.raw: Get-WmiObject -Class Win32_UserAccount
```
